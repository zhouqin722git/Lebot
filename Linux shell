# Linux相关

## 禁用/解禁ip/domain的命令 

禁用ip/domain
        iptables -I INPUT -s "cps.hansight.com" -j DROP
        iptables -I INPUT -s "cps.anquanyi.com" -j DROP
        iptables -I INPUT -s "ti.hansight.com" -j DROP
        iptables -I INPUT -s *.*.*.* -j DROP
解禁ip/domain
        iptables -D INPUT -s "cps.hansight.com"  -j DROP
        iptables -D INPUT -s "ti.hansight.com"  -j DROP
        iptables -D INPUT -s *.*.*.*  -j DROP
查看是否生效
        ping cps.hansight.com
        ping cps.anquanyi.com
        ping ti.hansight.com
查询域名对应的ip地址
        在DOS窗口输入命令： ping 空格 域名


## Linux中  ftp上传下载   url: https://www.jb51.net/article/129520.htm
        如：
        ftp [hostname | ip_address]
        > mget remote-files  #download 
        > mput local-files   #upload
        > bye  

## 
1、添加防火墙开放端口
    以修改配置文件的方式添加开放端口：
        vim /etc/firewalld/zones/public.xml
        以命令的方式添加开放端口：
        firewall-cmd --zone=public --add-port=8080/tcp --permanent
        添加完成后需要reload：
        firewall-cmd --reload
        查看已开放端口：
        firewall-cmd --list-all
        ---------》
	rule family="ipv4" port port="9092" protocol="tcp" accept
	rule family="ipv4" source address="10.217.62.65" port port="8444" protocol="tcp" accept（只对source address放开该端口）
        
        
##访问derby数据库
        [root@localhost ~]# cd /tmp/
        [root@localhost tmp]# nc -U dv_derby_ij_27274.sock   ##（该sock为master进程对应的sock）
        CONNECTION0* - 	jdbc:derby:db/api_derby
        * = current connection
        ij> show tables; (执行sql命令)
        ij> select * from T_RESOLVER_MASTER;
        ij> delete from T_RESOLVER_MASTER where name= 'AISA_behavior_HTTP';
        ij> delete from T_DATASOURCE_MASTER;

##shell中sed的用法
        1、在指定行的结尾添加指定字符串，如第2行的行尾添加“TAIL”：
                sed -i '2s/$/&TAIL/g' test.file  
        
        2、在每行的行尾添加字符，比如“TAIL”，命令如下：
                sed -i 's/$/&TAIL/g' test.file
                
        3、在每行的行首添加字符，比如"HEAD"，命令如下：
                sed -i 's/^/HEAD&/g' test.file
                
        4、在文本最后添加一行，比如：“Append_Line”,命令如下：
                sed -i '$a Append_Line' test_file
                
        5、在指定行添加注释#，如：2~8行，命令如下：
                sed -i '2,8s/^/#/' test_file
                
        6、在指定行取消注释#，如： 10,16行，命令如下：
                sed -i '10,16/#//' test_file
                
##shell中ftp用户名密码的用法
        wget url --ftp-user=username --ftp-password=password
        
##shell中ip的获取
        ip=`ifconfig|grep broadcast|awk '{print $2}'|head -1`

##shell中禁用虚拟网卡的用法
        https://www.cnblogs.com/kevingrace/p/5772589.html
        具体：
                virsh net-list
                virsh net-destroy default
                virsh net-undefine default
                service libvirtd restart

##pip

 1029  yum install epel-release
 1030  yum install python-pip
 1031  pip install requests
 1033  pip install --upgrade pip
 1034  pip install requests
 
 
 requirements文件：
        robotframework
        beautifulsoup4
        requests
        mysql-connector-python
        robotframework-sshlibrary
        
#下载rf相关的lib
pip install -r requirements


#执行pybot命令
 若报错：: /bash: pybot: command not command
 则表示版本问题。
 解决方案：
        sudo pip uninstall robotframework
        sudo pip install robotframework==3.0

#sshlibrary、paramiko保错，可能是版本不匹配的原因。
 对于Python 2.7而言
 解决方案：
        pip uninstall paramiko
        pip uninstall robotframework
        
        pip install paramiko==2.0.2
        pip install robotframework-sshlibrary==2.1.2
        
        
# Linux查看物理CPU个数、核数、逻辑CPU个数

        # 总核数 = 物理CPU个数 X 每颗物理CPU的核数 
        # 总逻辑CPU数 = 物理CPU个数 X 每颗物理CPU的核数 X 超线程数

        # 查看物理CPU个数
        cat /proc/cpuinfo| grep "physical id"| sort| uniq| wc -l

        # 查看每个物理CPU中core的个数(即核数)
        cat /proc/cpuinfo| grep "cpu cores"| uniq

        # 查看逻辑CPU的个数
        cat /proc/cpuinfo| grep "processor"| wc -l

         查看CPU信息（型号）
        cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c

        查看内 存信息
        # cat /proc/meminfo
        
 #### shell中的逻辑判断
        #!/bin/bash
        
        BASEPATH=${cd `dirname $0`; pwd}
        pid=`ps -ef|grep -v 'grep' | grep sae-ui.jar |awk '{print $2}'`
        if [ ! -n "$pid"]; then
                pushd ${BASEPATH}
                java -jar ${BASEPATH}/sae-ui.jar > tmp.log &
                echo "sae web ui starting"
                echo "see ./logs/sae_ui.log"
                popd
        else
                echo "sae_ui exit ${pid} do not need to start"
        fi
        
    知识点：
        1、变量赋值，等号两边不允许有空格
        
        2、grep -v 'xx' 表示: 显示去除包含xx的所有行,即显示不包含匹配文本的所有行
        
        3、if条件中的"-n 字符串"：表示字符串的长度不为0则为真
        
        4、条件中的叹号“！”，表示“取反，非”的意思
        
        5、管道符 一个竖线：| 
        
        管道符号，是unix一个很强大的功能,符号为一条竖线:"|"。
        用法: command 1 | command 2 他的功能是把第一个命令command 1执行的结果作为command 2的输入传给command 2，例如:

                $ls -s|sort -nr (请注意不要复制$符号进去哦)

                -s 是file size，-n是numeric-sort，-r是reverse，反转
                该命令列出当前目录中的文档(含size)，并把输出送给sort命令作为输入，sort命令按数字递减的顺序把ls的输出排序。
                
         6、pushd和popd:
                使用场景：主要是为了保证 if条件执行之后，目录不变，即函数退出后，计数器等相关保持不变
                pushd命令常用于将目录加入到栈中，加入记录到目录栈顶部，并切换到该目录；若pushd命令不加任何参数，则会将位于记录栈最上面的2个目录对换位置

                popd用于删除目录栈中的记录；如果popd命令不加任何参数，则会先删除目录栈最上面的记录，然后切换到删除过后的目录栈中的最上面的目录
                
